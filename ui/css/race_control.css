/* ======================================================================
  RACE CONTROL - cleaned + organized (multiline formatting)
   Keeps existing visuals; removes duplicates; clarifies cascade.
   ====================================================================== */

/* ========== 1) GLOBAL TOKENS ========== */
:root {
  --toolbarH: 56px;

  /* One knob for the shared flag pulse period */
  --syncPulseMs: 1000ms; /* 1.00s default; tweak for faster/slower beacon */

  /* Flags */
  --flag-col-w: 200px;
  --flag-btn-h: 88px;
  --flag-btn-fz: 20px;
  --flag-gap: 8px;

  /* Palette */
  --bg: #0b131b;
  --panel: #0f1a24;
  --panel-edge: #213243;
  --panel-shadow: rgba(0, 0, 0, .35);
  --text: #e6edf3;
  --text-dim: #c0cad3;
  --text-muted: #99a7b4;
  --title-bar-top: #15627A;
  --title-bar-bot: #104C60;
  --title-bar-edge: #2a475e;
  --title-text: #e8f2fb;
  --table-bg: #090f16;
  --table-head-bg: #0b1219;
  --table-row-alt: rgba(255,255,255,.015);
  --table-row-hover: rgba(255,255,255,.03);
  --table-row-border: rgba(255,255,255,.06);
  --flag-green:   #1fb15b;
  --flag-yellow:  #e0b11f;
  --flag-red:     #d04747;
  --flag-blue:    #3a78e0;
  --flag-white:   #f0f3f7;
  --flag-pre:     #7b8a97;
  --teal-edge: #2b4a63;

  /* Standings sizing */
  --standings-row-h: 44px;
  --standings-row-divider: 1px;
  --teal-1: #15627A;
  --teal-2: #104C60;
  --teal-edge: #2b4a63;
  --btn-bg: #172532;
  --btn-border: #263546;
  --btn-text: var(--text);
  --btn-success-top: #1f7a4d;
  --btn-success-bot: #165a39;
  --btn-success-border: #2c5f47;
  --btn-danger-top: #8b3434;
  --btn-danger-bot: #672525;
  --btn-danger-border: #6d3a3a;
  
  /* Flag pad */
  --flag-pad-border: #2a3b4b;
  --flag-text-light: #ffffff;
  --flag-pre-btn-bg: #26323c;
  --flag-pre-btn-border: #1d2931;
  --flag-pre-btn-text: var(--text);
  --flag-green-border: #1a8c4a;
  --flag-yellow-border: #b38d19;
  --flag-yellow-text: #1a1a1a;
  --flag-red-border: #a33a3a;
  --flag-blue-border: #2f63bb;
  --flag-white-border: #cfd9e4;
  --flag-white-text: #151a20;
  --flag-checker-border: #4a5664;
  
  /* Flag chips */
  --chip-bg: #2b3b4b;
  --chip-border: #3b4d61;
  --chip-green-bg: #1c7a3a;
  --chip-green-border: #2a7a4b;
  --chip-yellow-bg: #a4861e;
  --chip-yellow-border: #b79a2a;
  --chip-white-bg: #bfc6cf;
  --chip-white-border: #d1d7de;
  --chip-white-text: #111111;
  --chip-red-bg: #9a2e2e;
  --chip-red-border: #b23b3b;
  --chip-blue-bg: #2c5fb7;
  --chip-blue-border: #3c6fcc;
  --standings-visible-rows: 16;
  --standings-visible-height: calc(
    var(--standings-header-h) + 
    (var(--standings-row-h) + var(--standings-row-divider)) * var(--standings-visible-rows) +
    var(--standings-pad-top, 8px) + 
    var(--standings-pad-bottom, 8px)
  );

  /* Clock */
  --big-clock-size: 56px;
  --clock-font: "SF Mono", "Roboto Mono", Consolas, "Liberation Mono", Menlo, monospace;
}

/* ========== 2) PAGE LAYOUT ========== */
body.race-control {
  --gutterX: 16px;
  min-width: 1920px;
  min-height: 1080px;
  height: 100vh;
  overflow: hidden;
  background: var(--bg);
  color: var(--text);
}

body.race-control main.rcWrap {
  flex: 0 0 auto;
}

.rcWrap {
  display: grid;
  grid-template-rows: minmax(var(--toolbarH), auto) 1fr;
  gap: 12px;
  padding: 12px 16px 16px;
  width: 1920px;
  max-width: 1920px;
  height: calc(100vh - var(--headerH-ops) - var(--footer-h));
  margin: 0 auto;
  box-sizing: border-box;
  min-height: 0;
  overflow: hidden;
}

.rcGrid {
  display: grid;
  grid-template-columns: var(--flag-col-w) 1fr;
  grid-template-rows: auto 1fr;
  column-gap: 16px;
  row-gap: 12px;
  min-height: 0;
  height: 100%;
}

#paneFlags {
  grid-column: 1;
  grid-row: 1 / span 2;
}

#paneClock {
  grid-column: 2;
  grid-row: 1;
}

#paneLive {
  grid-column: 2;
  grid-row: 2;
}

/* ========== 3) PANE & TOOLBAR ========== */
.pane {
  background: var(--panel);
  border: 1px solid var(--panel-edge);
  border-radius: 12px;
  box-shadow: 0 2px 8px var(--panel-shadow);
  display: grid;
  grid-template-rows: auto 1fr;
  min-height: 0;
}

.pane__head {
  margin: 0 0 10px;
  padding: 8px 12px;
  color: var(--title-text);
  font-weight: 700;
  line-height: 1.2;
  letter-spacing: .02em;
  background: linear-gradient(180deg, var(--title-bar-top), var(--title-bar-bot));
  border: 1px solid var(--title-bar-edge);
  border-radius: 2px;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .08);
  font-size: 16px;
}

.pane__body {
  padding: 12px;
  overflow: auto;
}

/* hide headers for these panes */
.race-control #paneFlags .pane__head,
.race-control #paneClock .pane__head,
.race-control #paneLive .pane__head {
  display: none;
}

.race-control #paneFlags,
.race-control #paneClock,
.race-control #paneLive {
  grid-template-rows: 1fr;
}

.toolBar {
  display: flex;
  align-items: center;
  gap: 10px 12px;
  padding: 10px 12px;
  margin: 0;
  min-height: var(--toolbarH);
  background: var(--panel);
  border: 1px solid var(--panel-edge);
  border-radius: 10px;
  box-shadow: 0 2px 8px var(--panel-shadow);
  position: relative;
  z-index: 1;
}

.toolBar .left,
.toolBar .right {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 10px 12px;
}

.toolBar .sep {
  opacity: .35;
  padding: 0 4px;
  user-select: none;
}

.toolTitle {
  color: #e8f2fb;
  font-weight: 700;
  padding: 6px 10px;
  background: linear-gradient(180deg, #15627A, #104C60);
  border: 1px solid #2a475e;
  border-radius: 8px;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .08);
  margin-right: 10px;
  white-space: nowrap;
  font-size: 14px;
  line-height: 1;
}

/* ========== 4) BUTTONS/INPUTS ========== */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 8px;
  background: #172532;
  border: 1px solid #263546;
  color: var(--text);
  cursor: pointer;
}

.btn-primary {
  background: linear-gradient(180deg, var(--teal-1), var(--teal-2));
  border-color: var(--teal-edge);
  color: #e6f7ff;
}

.btn-success {
  background: linear-gradient(180deg, #1f7a4d, #165a39);
  border-color: #2c5f47;
}

.btn-danger {
  background: linear-gradient(180deg, #8b3434, #672525);
  border-color: #6d3a3a;
}

.btn--sm {
  padding: 4px 10px;
  font-size: 12px;
  border-radius: 6px;
}

.radio,
.checkbox {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.toolBar .btn,
.toolBar .pill,
.toolBar .radio {
  margin-top: 0;
  margin-bottom: 0;
}

.toolBar * {
  line-height: 1;
}

/* ========== 5) FLAGS COLUMN ========== */
#paneFlags {
  width: 100%;
}

#paneFlags .pane__body {
  display: grid;
  grid-template-columns: 1fr;
  padding: 8px;
  gap: var(--flag-gap);
}

/* pre-race half-height row */
#preFlagRow {
  width: 100%;
  min-width: 0;
  height: calc(var(--flag-btn-h) / 2);
  margin-bottom: calc(var(--flag-gap) * 3);
  display: grid;
}

#preFlagRow .flag {
  font-size: calc(var(--flag-btn-fz) * 0.9);
}

#flagPad.flag-pad {
  display: grid;
  grid-template-columns: 1fr;
  grid-auto-rows: var(--flag-btn-h);
  row-gap: var(--flag-gap);
}

#flagPad .flag,
#preFlagRow .flag {
  width: 100%;
  height: 100%;
  padding: 0;
  border-radius: 8px;
  font-weight: 800;
  display: grid;
  place-items: center;
  line-height: 1.1;
  letter-spacing: .02em;
  color: #fff;
  border: 1px solid #2a3b4b;
  cursor: pointer;
}

#flagPad .flag {
  font-size: var(--flag-btn-fz);
}

#flagPad .flag:hover,
#preFlagRow .flag:hover {
  filter: brightness(1.06);
}

#flagPad .flag:active,
#preFlagRow .flag:active {
  transform: translateY(1px);
}

/* default pre-race tone (darker slate) */
#preFlagRow .flag--pre {
  background: #26323c;
  border-color: #1d2931;
  color: #e6edf3;
}

#flagPad .flag--green {
  background: #1fb15b;
  border-color: #1a8c4a;
}

#flagPad .flag--yellow {
  background: #e0b11f;
  border-color: #b38d19;
  color: #1a1a1a;
}

#flagPad .flag--red {
  background: #d04747;
  border-color: #a33a3a;
}

#flagPad .flag--blue {
  background: #3a78e0;
  border-color: #2f63bb;
}

#flagPad .flag--white {
  background: #f0f3f7;
  border-color: #cfd9e4;
  color: #151a20;
}

#flagPad .flag--checkered {
  position: relative;
  color: #fff;
  border-color: #4a5664;
  background: repeating-linear-gradient(45deg, #000 0 16px, #fff 16px 32px);
  text-shadow: 0 1px 2px rgba(0, 0, 0, .8), 0 0 2px rgba(0, 0, 0, .6);
}

#flagPad .flag--checkered::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, .25);
  border-radius: 8px;
  pointer-events: none;
}

/* active state + pulse (final authority) */
@keyframes flagPulse {
  0% {
    transform: scale(1);
    filter: brightness(1);
  }
  50% {
    transform: scale(1.03);
    filter: brightness(1.12);
  }
  100% {
    transform: scale(1);
    filter: brightness(1);
  }
}

#paneFlags #flagPad .flag.is-active,
#paneFlags #preFlagRow .flag.is-active {
  outline: 2px solid rgba(255, 255, 255, .18);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, .12);
  animation: flagPulse var(--syncPulseMs) ease-in-out infinite;
}

#paneFlags #flagPad .flag--green.is-active {
  animation: none;
  filter: brightness(1.5) saturate(1.08);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, .12), 0 0 16px rgba(80, 220, 120, .38);
}

/* ========== 6) CLOCK ROW ========== */
#paneClock .pane__body {
  overflow: hidden;
}

#paneClock .clockBody {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px 12px;
  position: relative;
}

/* left cluster: actions */
.clockActions {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* deliberate wide gap after Pre-Race → Start Race */
#btnStartPrep {
  margin-right: 32px;
}

/* right cluster: Mode + big clock */
.clockDisplay {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 12px;
}

#paneClock .clockMeta {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  min-width: 140px;
  width: 160px;
}

#paneClock .toolbar-label {
  color: var(--text-muted);
  font-size: 12px;
  line-height: 1;
}

/* clock typography (authoritative) */
.bigClock,
.clock {
  font-family: var(--clock-font);
  font-variant-numeric: tabular-nums lining-nums;
  -webkit-font-feature-settings: "tnum" 1, "lnum" 1;
  font-feature-settings: "tnum" 1, "lnum" 1;
  letter-spacing: .03em;
}

.bigClock {
  font-size: clamp(48px, 6.5vw, var(--big-clock-size, 80px));
  font-weight: 900;
  line-height: 1;
  color: #e6f3ff;
  text-shadow: 0 2px 10px rgba(0, 0, 0, .45);
  min-width: 8ch;
  text-align: right;
}

#btnClockMode {
  min-width: 12ch;
}

/* ========== 7) LIVE LISTS / TIMERS ========== */
.timers {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 12px;
}

.timer {
  background: rgba(255, 255, 255, .02);
  border: 1px solid var(--panel-edge);
  border-radius: 8px;
  padding: 10px;
}

.timer__label {
  color: var(--text-dim);
  margin-bottom: 6px;
}

.timer__value {
  font-size: 28px;
  font-weight: 900;
}

.liveSplit {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  min-height: 0;
}

.liveHead {
  font-weight: 700;
  margin-bottom: 6px;
}

/* ========== 8) MISC ========== */
.flag-chip {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 999px;
  font-weight: 800;
  background: #2b3b4b;
  border: 1px solid #3b4d61;
}

.flag-chip[data-flag="green"] {
  background: #1c7a3a;
  border-color: #2a7a4b;
}

.flag-chip[data-flag="yellow"] {
  background: #a4861e;
  border-color: #b79a2a;
}

.flag-chip[data-flag="white"] {
  background: #bfc6cf;
  color: #111;
  border-color: #d1d7de;
}

.flag-chip[data-flag="red"] {
  background: #9a2e2e;
  border-color: #b23b3b;
}

.flag-chip[data-flag="blue"] {
  background: #2c5fb7;
  border-color: #3c6fcc;
}

#flagInfo {
  min-width: 0;
  color: var(--text-muted);
}

#flagInfo .hint {
  margin-top: 2px;
}

.hidden {
  display: none !important;
}

/* Clock strip / toolbars feel like Setup cards */
.race-control .clockRow,
.race-control #paneClock .pane__body {
  background: var(--panel);
  border: 1px solid var(--panel-edge);
  border-radius: 10px;
  box-shadow: 0 2px 8px var(--panel-shadow);
}

/* Flags panel body */
.race-control #paneFlags .pane__body {
  background: #0e1821; /* slightly darker than panel for depth */
  border: 1px solid var(--panel-edge);
  border-radius: 10px;
}

/* Live feed / lists */
.race-control #paneLive .pane__body,
.race-control #paneData .pane__body {
  background: #080f16;
  border: 1px solid var(--panel-edge);
  border-radius: 10px;
  color: #f2f7ff;
}

.race-control #paneLive .pane__body {
  /* Make inner panels stack vertically and let the standings pane grow */
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 12px;
  height: 100%;
  box-sizing: border-box;
  overflow: hidden;
}

/* Chips, small labels */
.race-control .toolbar-label,
.race-control .chip {
  color: var(--text-muted);
}

/* ---- Race Control: Last Lap Feed styling ---- */
#panelFeed {
  --feed-gap: 8px;
  --feed-pad: 10px;
  --feed-row-bg: var(--pane-bg, #121418);
  --feed-row-border: rgba(255,255,255,0.06);
  --feed-accent: var(--brand-accent, #7fd);
  --feed-mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
}

/* make list look like a neat ticker */
#lapFeed {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: var(--feed-gap);
}

/* each row is a soft card with grid columns */
#lapFeed .liveRow {
  display: grid;
  grid-template-columns: 72px 1fr repeat(3, minmax(92px, 120px));
  align-items: center;
  gap: 12px;
  padding: var(--feed-pad);
  background: var(--feed-row-bg);
  border: 1px solid var(--feed-row-border);
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.18);
}

/* cells */
#lapFeed .liveCell {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Number pill */
#lapFeed .liveNum {
  justify-self: start;
  font-weight: 700;
  letter-spacing: 0.2px;
  color: #0ad5c1;
  background: rgba(10, 213, 193, 0.1);
  border: 1px solid rgba(10, 213, 193, 0.35);
  padding: 4px 8px;
  border-radius: 999px;
}

/* Name trims nicely and can grow */
#lapFeed .liveName {
  font-weight: 600;
  color: #e8eef7;
  min-width: 120px;
}

/* lap/time buckets use monospace and right-align */
#lapFeed .liveLaps,
#lapFeed .liveLast,
#lapFeed .liveBest {
  font-family: var(--feed-mono);
  justify-self: end;
  color: #cfd7e3;
}

/* emphasize best */
#lapFeed .liveBest {
  color: var(--feed-accent);
  font-weight: 600;
}



/* ===== Unified table skin for Standings + Seen ===================== */
:root {
  --rowH: var(--standings-row-h);
  --thH:  var(--standings-header-h);
}

/* Scroll containers for both tables (same chrome) */
.standingsScroll,
.seenScroll {
  background: var(--table-bg);           /* unified dark base */
  border: 1px solid var(--panel-edge);
  border-radius: 10px;
  box-shadow: 0 2px 8px var(--panel-shadow);
  padding-top: var(--standings-pad-top, 8px);
  padding-bottom: var(--standings-pad-bottom, 8px);
  overflow: hidden;                      /* default: no scroll */
}

/* Enable internal scroll when >16 entrants */
.standingsScroll.has-scroll,
.standingsScroll.is-scroll,
.seenScroll.has-scroll,
.seenScroll.is-scroll {
  overflow: auto;
  max-height: calc(
    var(--thH) + var(--rowH) * 16
    + var(--standings-pad-top, 8px)
    + var(--standings-pad-bottom, 8px)
  );
}

/* Seen pane has a fixed viewport so the scrollbar appears internally */
.seenScroll {
  height: calc(
    var(--thH) + var(--rowH) * 16
    + var(--standings-pad-top, 8px)
    + var(--standings-pad-bottom, 8px)
  );
}

/* Same table look for both: id OR class */
#rcStandings,
.rcTable {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-variant-numeric: tabular-nums;
}

.rcTable {
  color: var(--text);
  background: var(--table-bg);
}

/* Header */
/* Normalize table header height across Seen + Standings */
#rcStandings thead th,
.rcTable thead th {
  /* exact cap height - no vertical padding that would change total box size */
  height: var(--standings-header-h);
  line-height: var(--standings-header-h);
  padding: 0 14px;           /* horizontal only, vertical = 0 */
}


.rcTable thead th {
  background: var(--table-head-bg);
  border-bottom: 1px solid rgba(255,255,255,.14);
  color: #d8e9ff;
  text-align: left;
}

/* Body rows */
.rcTable tbody tr { height: var(--rowH); }
.rcTable tbody tr:nth-child(2n) { background: var(--table-row-alt); }
.rcTable tbody tr:hover { background: var(--table-row-hover); }

/* Cells */
#rcStandings td, #rcStandings th,
.rcTable td, .rcTable th {
  padding: 0 14px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.rcTable tbody td {
  border-bottom: var(--standings-row-divider) solid var(--table-row-border);
}

#rcStandings tbody tr:last-child td,
.rcTable tbody tr:last-child td {
  border-bottom: 0;
}

.rcTable tbody tr.pad td {
  color: rgba(255,255,255,.28);
}

#rcStandings tbody tr.is-awaiting-detect {
  color: var(--text-muted);
  opacity: .72;
}

#rcStandings tbody tr.is-awaiting-detect td {
  color: inherit;
}

/* Column alignment helpers shared by both tables */
#rcStandings .pos,   .rcTable .pos   { width: 48px;  text-align: center; }
#rcStandings .num,   .rcTable .num   { width: 9ch; text-align: center; }
#rcStandings th.num, .rcTable th.num { text-align: center; }
#rcStandings th.pos, #rcStandings td.pos,
.rcTable th.pos, .rcTable td.pos {
  padding-left: 8px;
  padding-right: 8px;
}
#rcStandings th.num, #rcStandings td.num,
.rcTable th.num, .rcTable td.num {
  padding-left: 8px;
  padding-right: 8px;
}
.rcTable th.tag,
.rcTable td.tag {
  padding-right: 8px;
}
.rcTable td.tag code {
  padding-left: 6px;
  padding-right: 6px;
}

/* Seen table: tighten Tag↔Number spacing further without affecting standings */
#rcSeen {
  table-layout: fixed;
}

#rcSeen .tag {
  width: 12ch;
}

#rcSeen .num {
  width: 9ch;
}

#rcSeen .reads {
  width: 8ch;
}
#rcStandings .name,  .rcTable .name  { width: auto;  }
#rcStandings th.laps,  .rcTable th.laps,
#rcStandings th.last,  .rcTable th.last,
#rcStandings th.pace,  .rcTable th.pace,
#rcStandings th.best,  .rcTable th.best {
  text-align: right;
}

#rcStandings .laps,  .rcTable .laps,
#rcStandings .last,  .rcTable .last,
#rcStandings .pace,  .rcTable .pace,
#rcStandings .best,  .rcTable .best,
.rcTable .reads {
  width: 14ch;
  min-width: 14ch;
  text-align: right;
}

/* Use race clock typeface for time values (body only) */
#rcStandings td.laps,
#rcStandings td.last,
#rcStandings td.pace,
#rcStandings td.best,
.rcTable td.laps,
.rcTable td.last,
.rcTable td.pace,
.rcTable td.best {
  font-family: var(--clock-font);
  font-size: clamp(18px, calc(var(--rowH) * 0.6), 28px);
  font-weight: 550;
  letter-spacing: .02em;
  line-height: 1.05;
}

#rcStandings td.laps,
#rcStandings td.last,
#rcStandings td.pace,
#rcStandings td.best,
.rcTable td.laps,
.rcTable td.last,
.rcTable td.pace,
.rcTable td.best {
  overflow: visible;
  text-overflow: clip;
}

/* Code-ish tag style for Seen table */
.rcTable .tag code {
  font-family: var(--clock-font);
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  padding: 2px 6px;
  border-radius: 6px;
}

/* Section header bar above the tables (Seen + Standings) */
.standingsHead,
#panelSeen .standingsHead {
  margin-bottom: 8px;
  padding: 8px 10px;
  font-weight: 700;
  color: var(--text);
  background: #0d1117;
  border: 1px solid var(--panel-edge);
  border-radius: 8px;
}
.standingsHead .title .muted { color: var(--text-muted); }

/* Right-aligned summary in the Start settings row */
.toolbar {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
}

.toolbar-spacer {
  flex: 1 1 auto;
}

/* Summary text (mirror of .race-setup .summary) */
.rc-summary {
  font-size: 18px;
  color: var(--text-muted);
  white-space: nowrap;
}

/* Optional: trim on very narrow screens */
@media (max-width: 900px) {
  .rc-summary { font-size: 16px; }
}
/* Center holder keeps the pill fixed-width and centered */
.toolbar-center {
  flex: 1 1 auto;
  display: flex;
  justify-content: center;
}

/* Flag pill */
#flagPill {
  width: min(500px, 55vw);
  min-width: 320px;
  height: 36px;                 /* low profile */
  border-radius: 999px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 16px;
  font-weight: 800;
  letter-spacing: 0.4px;
  text-transform: uppercase;
  border: 1px solid rgba(0,0,0,0.15);
  box-shadow: 0 10px 22px rgba(0,0,0,0.25), inset 0 0 0 1px rgba(255,255,255,0.10);
  color: #0a0d10;               /* default dark text; overridden per-flag */
  user-select: none;
}

/* Text inside */
#flagPillText {
  font-size: clamp(16px, 2.2vw, 20px);
}

/* Pulse once on change */
#flagPill.pulse {
  animation: flagPillPulse 1s ease-out 1;
}
@keyframes flagPillPulse {
  0%   { transform: scale(0.98); box-shadow: 0 0 0 0 rgba(255,255,255,0.4); }
  45%  { transform: scale(1.015); box-shadow: 0 0 0 10px rgba(255,255,255,0.18); }
  100% { transform: scale(1.0);  box-shadow: 0 10px 22px rgba(0,0,0,0.25), inset 0 0 0 1px rgba(255,255,255,0.10); }
}

body[data-flag="GREEN"]     #flagPill { background: var(--flag-green);  color:#04130a; }
body[data-flag="YELLOW"]    #flagPill { background: var(--flag-yellow); color:#221c00; }
body[data-flag="RED"]       #flagPill { background: var(--flag-red);    color:#1b0004; }
body[data-flag="BLUE"]      #flagPill { background: var(--flag-blue);   color:#051121; }
body[data-flag="WHITE"]     #flagPill { background: var(--flag-white);  color:#071017; }
body[data-phase="pre"]      #flagPill,
body[data-flag="PRE"]       #flagPill { background: var(--flag-pre);    color:#071017; }
body[data-flag="CHECKERED"] #flagPill {
  background:
    repeating-linear-gradient(45deg, #fff 0 16px, #121212 16px 32px);
  color:#0a0d10;
  text-shadow: 0 1px 0 rgba(255,255,255,0.35);
}

/* prefer-reduced-motion: disable the loop for accessibility */
@media (prefers-reduced-motion: reduce) {
  #flagPill.beacon { animation: none !important; }
}
#raceClock {
  font-variant-numeric: tabular-nums;
  font-feature-settings: "tnum";
  min-width: 10ch;   /* space for sign + hh:mm:ss */
  text-align: center;
}

#raceClock {
  display: inline-flex;
  align-items: baseline;
  justify-content: center;
  font-variant-numeric: tabular-nums;
  font-feature-settings: "tnum";
}
#raceClock .clock-sign   { display:inline-block; width:1ch; text-align:right; }
#raceClock .clock-digits { display:inline-block; }

.post-finish {
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  top: 50%;
  left: 400px;
  transform: translateY(-50%);
  margin: 0;
  z-index: 2;
  pointer-events: auto;
  opacity: 1;
}

/* Hidden until CHECKERED */
.post-finish.hidden {
  opacity: 0;
  pointer-events: none;
}

/* Blue, centered, roomy, with a little gap from Abort */
.btn--results {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 360px;
  padding: 10px 22px;
  font-size: 16px;
  font-weight: 700;
  text-align: center;

  /* use your palette if present; otherwise sane fallbacks */
  color: #fff;
  background: var(--blue-500, #2b6ff7);
  border: 1px solid var(--blue-600, #2058c7);
  border-radius: 10px;

  /* extra space before this button */
  margin-left: 16px;
  flex-shrink: 0; /* prevent flexbox from squeezing it to zero width */
}

.btn--results:hover {
  filter: brightness(1.08);
}

/* Gentle breathing pulse reserved for the results CTA */
@keyframes breathe {
  0%   { transform: scale(1);    box-shadow: 0 0 0 0 rgba(43,111,247,0.20); }
  45%  { transform: scale(1.04); box-shadow: 0 0 20px 0 rgba(43,111,247,0.26); }
  100% { transform: scale(1);    box-shadow: 0 0 0 0 rgba(43,111,247,0.20); }
}

.btn--breathing {
  animation: breathe 2.6s ease-in-out infinite;
}
/* Shared pulse for pad + pill - uses the same flagPulse keyframes */
#flagPill.beacon {
  animation: flagPulse var(--syncPulseMs) ease-in-out infinite;
  will-change: transform, box-shadow, filter;
}

/* Single bright flash on flag change - doesn't interfere with beacon timing */
#flagPill.flash {
  filter: brightness(4.5) saturate(1.3);
  transition: filter 150ms ease-out;
}

/* Removed separate flagFlash keyframes to avoid timing conflicts */

/* ==== Standings: dark pane, near-white text, sticky header, inner scroll ==== */
.race-control #panelStandings {
  /* Fixed-height rows + flex keeps 16 entrants visible without outer scrollbars */
  display: flex;
  flex-direction: column;
  flex: 0 0 auto;
}

.race-control #panelStandings .standingsScroll {
  /* Only this container scrolls when the field exceeds 16 entrants */
  flex: 0 0 var(--standings-visible-height);
  height: var(--standings-visible-height);
  max-height: var(--standings-visible-height);
  min-height: var(--standings-visible-height);
  overflow-y: auto;
  overflow-x: hidden;
  border: 1px solid var(--panel-edge);
  border-radius: 10px;
  background: var(--table-bg); /* deep navy */
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02);
  box-sizing: border-box;
  /* Breathing room kept tight so the panel fits a 1080p viewport */
  padding-top: var(--standings-pad-top);
  padding-bottom: var(--standings-pad-bottom);
}

.race-control #rcStandings {
  /* Sticky header table for live standings */
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
  color: #edf4ff;
  font-variant-numeric: tabular-nums;
}

.race-control #rcStandings thead th {
  position: sticky; top: var(--standings-pad-top, 0px); z-index: 1;
  background: var(--table-head-bg);
  color: #d8e9ff;
  font-weight: 700;
  text-align: left;
  padding: 10px 14px;
  height: var(--standings-header-h);
  line-height: var(--standings-header-h);
  border-bottom: 1px solid rgba(255,255,255,.14);
}

.race-control #rcStandings tbody td {
  padding: 0 14px;
  height: var(--standings-row-h);
  line-height: var(--standings-row-h);
  border-bottom: var(--standings-row-divider) solid var(--table-row-border);
  white-space: nowrap;
  overflow: visible;
  text-overflow: clip;
  color: #f2f7ff;
}

.race-control #rcStandings tbody tr:last-child td {
  border-bottom: 0;
}

.race-control #rcStandings tbody tr:nth-child(2n) {
  background: var(--table-row-alt);
}

.race-control #rcStandings th.pos,  .race-control #rcStandings td.pos  { width: 5ch;  text-align: center; padding-left: 8px; padding-right: 8px; }
.race-control #rcStandings th.num,  .race-control #rcStandings td.num  { width: 11ch;  text-align: center; }
.race-control #rcStandings th.laps, .race-control #rcStandings td.laps { width: 12ch; text-align: right; }
.race-control #rcStandings th.last, .race-control #rcStandings td.last { width: 16ch; text-align: right; }
.race-control #rcStandings th.pace, .race-control #rcStandings td.pace { width: 16ch; text-align: right; }
.race-control #rcStandings th.best,
.race-control #rcStandings td.best {
  width: 16ch;
  text-align: right;
  padding-right: 18px;
}

.race-control #rcStandings tbody tr.pad td {
  /* Placeholder rows keep the grid height stable while field < 16 */
  color: rgba(255,255,255,.28);
}

/* Qualifying-only Brake column: hidden by default */
#rcStandings th.col-brake,
#rcStandings td.col-brake,
#rcSeen      th.col-brake,
#rcSeen      td.col-brake { display: none; }

/* Visible only when this heat is qualifying */
body.is-qualifying #rcStandings th.col-brake,
body.is-qualifying #rcStandings td.col-brake,
body.is-qualifying #rcSeen      th.col-brake,
body.is-qualifying #rcSeen      td.col-brake { display: table-cell; }

/* Stable sizing so adding the column doesn’t wiggle layout */
#rcStandings th.brake, #rcStandings td.brake,
#rcSeen      th.brake, #rcSeen      td.brake {
  width: 7.5ch;
  text-align: center;
  padding-left: 6px;
  padding-right: 6px;
}

/* Button visual states */
.brake-toggle { min-width: 6ch; font-weight: 700; }
.brake-toggle.is-yes {
  background: linear-gradient(180deg, #1f7a4d, #165a39);
  border-color:#2c5f47; color:#eafff4;
}
.brake-toggle.is-no {
  background: linear-gradient(180deg, #8b3434, #672525);
  border-color:#6d3a3a; color:#fff3f3;
}
.brake-toggle.is-unk {
  background: #172532; border:1px solid #263546; color:#cfd7e3;
}
